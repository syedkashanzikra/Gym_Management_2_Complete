import{_ as x,aE as a,M as C,r,o as d,a as h,w as c,e as f,f as u,h as w,t as V,J as q,d as N,ag as O,F as P}from"./index.46fdd451.js";import{Q as $}from"./QPage.701dd41d.js";import{S as B}from"./SkeletonSinglePage.f05b1d90.js";import{u as F}from"./template.90696750.js";import{C as J}from"./ClassSchedules.77de3ed8.js";import"./QSkeleton.a3e15f44.js";import"./QItemLabel.249954d1.js";import"./QExpansionItem.fdf07114.js";import"./class-list.763448d9.js";import"./location.aec3ed16.js";import"./instructor.60bbdc9f.js";const S={Monday:[],Tuesday:[],Wednesday:[],Thursday:[],Friday:[],Saturday:[],Sunday:[]},_={is_active:!0,schedules:S},y=e=>{let s=a.exports.groupBy(e.schedules,n=>n.day),o=a.exports.cloneDeep(S);return Object.keys(o).forEach(n=>{o[n]=s[n]||[]}),Object.assign(a.exports.cloneDeep(e),{schedules:o})},R={components:{SkeletonSinglePage:B,ClassSchedules:J},data(){return{default:a.exports.cloneDeep(_),template:a.exports.cloneDeep(_),loaded:!1,submited:!1}},methods:{...C(F,["store","show","update"]),onSubmit(e){console.func("pages/admins/templates/TemplatePage:methods.onSubmit()",arguments),this.submited=!0;const s=this.creating?this.store:this.update,o=a.exports.cloneDeep(this.template),n=Object.values(o.schedules);o.schedules=[].concat(...n),s(o).then(({data:t,message:l})=>{this.submited=!1,this.loaded=!1,this.$nextTick(()=>{const m=y(t);this.template=m,this.default=a.exports.cloneDeep(m),this.loaded=!0}),this.$q.notify(l),this.$router.push({name:"Single Template",params:{id:t.id},query:{action:"edit"}})}).catch(t=>{this.submited=!1,this.$core.error(t,{title:this.$t("dialog.title.error")})})},onReset(e){console.func("pages/admins/templates/TemplatePage:methods.onReset()",arguments),this.loaded=!1,this.$nextTick(()=>{this.template=a.exports.cloneDeep(this.default),this.loaded=!0})},onCancel(e){console.func("pages/admins/templates/TemplatePage:methods.onCancel()",arguments),this.$router.go(-1)}},async mounted(){this.creating?this.loaded=!0:this.show(this.id).then(e=>{const s=y(e);this.template=s,this.default=a.exports.cloneDeep(s),this.loaded=!0}).catch(e=>{this.$emit("error",e)})},computed:{edit(){return["add","edit"].includes(this.action)||this.id==="add"},creating(){return this.id==="add"},id(){return this.$route.params.id},action(){return this.$route.query.action},disable(){return this.default&&JSON.stringify(this.template)===JSON.stringify(this.default)},resetable(){return this.default&&JSON.stringify(this.template)!==JSON.stringify(this.default)}}},U={class:"q-gutter-md"},j={class:"col-xs-12 col-sm-12"},E={class:"col-xs-12"},M={class:"q-pt-sm q-gutter-y-xs"};function Q(e,s,o,n,t,l){const m=r("base-label"),v=r("base-input"),b=r("base-section"),k=r("class-schedules"),D=r("base-form"),T=r("skeleton-single-page");return d(),h($,{padding:""},{default:c(()=>[t.loaded?(d(),h(D,{key:0,onSubmit:l.onSubmit,onCancel:l.onCancel,onReset:l.onReset,resetable:l.resetable,disable:l.disable,submited:t.submited,ref:"baseForm"},{default:c(()=>[f("div",U,[u(b,{flat:"",bordered:"",title:e.$t("generalInformation")},{default:c(()=>[f("div",j,[u(m,{required:""},{default:c(()=>[w(V(e.$t("label.label")),1)]),_:1}),u(v,{modelValue:t.template.label,"onUpdate:modelValue":s[0]||(s[0]=p=>t.template.label=p),name:"label",type:"text"},null,8,["modelValue"])]),f("div",E,[u(q,{dense:"",modelValue:t.template.is_active,"onUpdate:modelValue":s[1]||(s[1]=p=>t.template.is_active=p),label:e.$t("active"),color:"green"},null,8,["modelValue","label"])])]),_:1},8,["title"]),u(b,{flat:"",bordered:"",title:e.$t("templates.schedulesTitle"),description:e.$t("templates.schedulesDesc"),"no-row":""},{default:c(()=>[f("div",M,[(d(!0),N(P,null,O(t.template.schedules,(p,i)=>(d(),h(k,{key:i,day:i,rows:t.template.schedules[i],"onUpdate:rows":g=>t.template.schedules[i]=g,group:"schedules","default-opened":i==="Monday","can-save":!l.disable,onSave:s[2]||(s[2]=g=>e.$refs.baseForm.onSave())},null,8,["day","rows","onUpdate:rows","default-opened","can-save"]))),128))])]),_:1},8,["title","description"])])]),_:1},8,["onSubmit","onCancel","onReset","resetable","disable","submited"])):(d(),h(T,{key:1}))]),_:1})}var ee=x(R,[["render",Q]]);export{ee as default};
