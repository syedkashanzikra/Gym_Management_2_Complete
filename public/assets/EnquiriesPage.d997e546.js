import{Q as y}from"./QBanner.bf86e8e3.js";import{Q as w}from"./QPopupProxy.e4ea2ef4.js";import{_ as T,M as B,N as M,r as l,o as g,a as _,w as t,f as s,a5 as u,i as $,e as c,t as r,a4 as k,a8 as q,h as m,d as Q,F as R,J as v}from"./index.46fdd451.js";import{Q as U}from"./QPage.701dd41d.js";import{u as f}from"./enquiry.aa47bedc.js";import"./QMenu.84416a21.js";import"./selection.e9a8e664.js";const V={data(){return{loading:!1,loaded:!1,pagination:{sortBy:"last_reply",descending:!0,page:1,filter:"",status:this.$route.meta.status,advancedFilter:{},deleted:!1,rowsPerPage:15,rowsNumber:15,loaded:!1},useEnquiryStore:f()}},methods:{...B(f,["get","changeArchived","changeUserArchived"]),onRequest(a){console.func("pages/core/enquiries/EnquiriesPage:methods.onRequest()",arguments);const{page:o,rowsPerPage:b,sortBy:h,descending:i}=a.pagination;this.pagination=a.pagination,this.loading=!0,this.get({...a.pagination,direction:i?"desc":"asc"}).then(({meta:n})=>{this.pagination.rowsNumber=n.total,this.pagination.page=o,this.pagination.rowsPerPage=b,this.pagination.sortBy=h,this.pagination.descending=i,this.pagination.loaded=!0,this.pagination.from=n.from,this.pagination.to=n.to,this.loading=!1}).catch(n=>{this.$core.error(n,{title:this.$t("dialog.title.error")})})},async actionClicked(a,o){console.func("pages/core/enquiries/EnquiriesPage:methods.actionClicked()",arguments)},async toolbarClicked(a,o){console.func("pages/core/enquiries/EnquiriesPage:methods.toolbarClicked()",arguments)},async rowClicked(a,o){console.func("pages/core/enquiries/EnquiriesPage:methods.rowClicked()",arguments),this.$router.push({name:"Single Enquiry",params:{id:o.id},query:{action:"edit",title:o.subject||"Contact us"}})}},computed:{...M(f,["actions","rows","columns","module","toolbar","filters"]),getColumns(){return this.columns.filter(a=>a.guard.includes(this.guard))},guard(){return this.$route.meta.guard},getToolbar(){return this.toolbar.filter(a=>a.guard.includes(this.guard))},isAdmin(){return this.guard==="admins"}}},z={class:"ellipsis"},A=["innerHTML"],N=["innerHTML"];function H(a,o,b,h,i,n){const d=l("base-btn"),p=l("base-label"),C=l("base-status"),P=l("base-table"),E=l("base-section");return g(),_(U,{padding:""},{default:t(()=>[s(E,{flat:"",bordered:"","no-row":""},{default:t(()=>[s(P,{store:i.useEnquiryStore,module:a.module,actions:a.actions,columns:n.getColumns,rows:a.rows,toolbar:n.getToolbar,filters:a.filters,loading:i.loading,pagination:i.pagination,onRequest:n.onRequest,onToolbarClicked:n.toolbarClicked,onRowClicked:n.rowClicked,"no-data-label":a.$t("enquiries.noData"),"table-key":"enquiries"},{"body-cell-id":t(e=>[s(d,{onClick:o[0]||(o[0]=u(()=>{},["stop"])),link:"",tag:"a",align:"left",to:{name:"Single Enquiry",params:{id:e.row.id},query:{action:"edit",title:e.row.subject||a.$t("contactUs")}},style:$(e.col.style)},{default:t(()=>[c("div",z,r(e.value),1)]),_:2},1032,["to","style"]),k(s(d,{class:"q-ml-xs",size:"md",link:"",color:"black",icon:"fal fa-align-left",onClick:o[1]||(o[1]=u(()=>{},["stop"]))},{default:t(()=>[s(w,null,{default:t(()=>[s(y,{style:{width:"350px"}},{default:t(()=>[s(p,null,{default:t(()=>[m(r(a.$t("message")),1)]),_:1}),c("span",{innerHTML:e.row.message},null,8,A)]),_:2},1024)]),_:2},1024)]),_:2},1536),[[q,e.row.message]])]),"body-cell-name":t(e=>[e.row.user?(g(),_(d,{key:0,onClick:o[2]||(o[2]=u(()=>{},["stop"])),link:"",size:"12px",tag:"a",to:{name:"Single Member",params:{id:e.row.user.id},query:{action:"edit"}},label:e.value},null,8,["to","label"])):(g(),Q(R,{key:1},[m(r(e.value),1)],64))]),"body-cell-status":t(e=>[s(C,{type:e.value},null,8,["type"])]),"body-cell-is_archived":t(e=>[s(v,{"onUpdate:modelValue":S=>a.changeArchived(e.row),size:"sm",dense:"","model-value":e.row.is_archived,color:"green"},null,8,["onUpdate:modelValue","model-value"])]),"body-cell-user_archived":t(e=>[s(v,{"onUpdate:modelValue":S=>a.changeUserArchived(e.row),size:"sm",dense:"","model-value":e.row.user_archived,color:"green"},null,8,["onUpdate:modelValue","model-value"])]),"body-cell-last_reply":t(e=>[k(s(d,{class:"q-mr-xs",size:"md",link:"",color:"black",icon:"fal fa-align-left",onClick:o[3]||(o[3]=u(()=>{},["stop"]))},{default:t(()=>[s(w,null,{default:t(()=>[s(y,{style:{width:"350px"}},{default:t(()=>[s(p,null,{default:t(()=>[m(r(a.$t("lastMessage")),1)]),_:1}),c("span",{innerHTML:a.$core.nl2br(e.row.last_reply.message)},null,8,N)]),_:2},1024)]),_:2},1024)]),_:2},1536),[[q,e.row.last_reply]]),c("span",null,r(e.value),1)]),_:1},8,["store","module","actions","columns","rows","toolbar","filters","loading","pagination","onRequest","onToolbarClicked","onRowClicked","no-data-label"])]),_:1})]),_:1})}var I=T(V,[["render",H]]);export{I as default};
