import{_ as N,aE as h,M as _,u as D,r as m,o as g,a as V,w as i,e as n,f as t,h as d,t as u,Q as w,J as y,d as v,ag as J,F as Q}from"./index.46fdd451.js";import{Q as R}from"./QPage.701dd41d.js";import{P as A}from"./PermissionsModule.182b111b.js";import{S as B}from"./SkeletonSinglePage.f05b1d90.js";import{u as E}from"./staff.43951c10.js";import{u as G}from"./group.c7cfe585.js";import"./QItemLabel.249954d1.js";import"./QSkeleton.a3e15f44.js";const P={groups:[],permissions:[],groupPermissions:[],is_active:!1},I={components:{PermissionsModule:A,SkeletonSinglePage:B},data(){return{default:h.exports.cloneDeep(P),staff:h.exports.cloneDeep(P),modules:[],groups:[],selected:[],isPwd:!0,isConfPwd:!0,is_instructor:!1,loaded:!1,submited:!1}},methods:{..._(E,["store","show","update"]),..._(D,["getModules"]),..._(G,{groupList:"get"}),onSubmit(s){console.func("pages/core/staffs/StaffPage:methods.onSubmit()",arguments),this.submited=!0,(this.creating?this.store:this.update)(this.staff).then(({data:a,message:p})=>{this.submited=!1,this.$q.notify(p),this.staff=a,this.default=h.exports.cloneDeep(a),this.$router.push({name:"Single Staff",params:{id:a.id},query:{action:"edit"}})}).catch(a=>{this.submited=!1,this.$core.error(a,{title:this.$t("dialog.title.error")})})},onReset(s){console.func("pages/core/staffs/StaffPage:methods.onReset()",arguments),this.loaded=!1,this.$nextTick(()=>{this.staff=h.exports.cloneDeep(this.default),this.loaded=!0})},onCancel(s){console.func("pages/core/staffs/StaffPage:methods.onCancel()",arguments),this.$router.go(-1)},onChangeGroup(s){if(console.func("pages/core/staffs/StaffPage:methods.onChangeGroup()",arguments),s.length<1){this.staff.groupPermissions=[];return}s.forEach(o=>{o.permissions.length&&o.permissions.forEach(a=>{let p=this.staff.groupPermissions.find(e=>e.id===a.id);p&&a.pivot.access!==null?p.access=a.pivot.access:p||this.staff.groupPermissions.push({id:a.id,access:a.pivot.access})})})}},async mounted(){await this.getModules().then(s=>{this.modules=s.modules,this.groups=s.groups}),this.creating?this.loaded=!0:this.show(this.id).then(s=>{this.staff=s,this.default=h.exports.cloneDeep(s),this.loaded=!0}).catch(s=>{this.$emit("error",s)})},computed:{edit(){return["add","edit"].includes(this.action)||this.id==="add"},creating(){return this.id==="add"},id(){return this.$route.params.id},action(){return this.$route.query.action},disable(){return this.default&&JSON.stringify(this.staff)===JSON.stringify(this.default)},resetable(){return this.default&&JSON.stringify(this.staff)!==JSON.stringify(this.default)}}},M={class:"q-gutter-md"},O={class:"col-xs-12 col-sm-4"},F={class:"col-xs-12 col-sm-4"},L={class:"col-xs-12 col-sm-4"},z={class:"col-xs-12 col-sm-4"},T={class:"col-xs-12 col-sm-4"},j={class:"col-xs-12 col-sm-4"},H={class:"col-xs-12 col-sm-4"},K={class:"col-xs-12"},W={class:"col-xs-12"},X={class:"col-sm-4 col-xs-12"},Y={class:"col-xs-12"},Z={class:"row q-pt-md q-col-gutter-md"};function $(s,o,a,p,e,c){const r=m("base-label"),f=m("base-input"),b=m("base-section"),S=m("base-select"),C=m("permissions-module"),k=m("base-form"),U=m("skeleton-single-page");return g(),V(R,{padding:""},{default:i(()=>[e.loaded?(g(),V(k,{key:0,onSubmit:c.onSubmit,onCancel:c.onCancel,onReset:c.onReset,resetable:c.resetable,disable:c.disable,submited:e.submited},{default:i(()=>[n("div",M,[t(b,{flat:"",bordered:"",title:s.$t("generalInformation"),description:s.$t("staff.generalDesc")},{default:i(()=>[n("div",O,[t(r,{required:""},{default:i(()=>[d(u(s.$t("firstName")),1)]),_:1}),t(f,{name:"first_name",modelValue:e.staff.first_name,"onUpdate:modelValue":o[0]||(o[0]=l=>e.staff.first_name=l)},null,8,["modelValue"])]),n("div",F,[t(r,{required:""},{default:i(()=>[d(u(s.$t("surname")),1)]),_:1}),t(f,{name:"last_name",modelValue:e.staff.last_name,"onUpdate:modelValue":o[1]||(o[1]=l=>e.staff.last_name=l)},null,8,["modelValue"])]),n("div",L,[t(r,{required:""},{default:i(()=>[d(u(s.$t("emailAddress")),1)]),_:1}),t(f,{name:"email",modelValue:e.staff.email,"onUpdate:modelValue":o[2]||(o[2]=l=>e.staff.email=l),type:"email"},null,8,["modelValue"])]),n("div",z,[t(r,null,{default:i(()=>[d(u(s.$t("phoneNumber")),1)]),_:1}),t(f,{name:"phone_number",modelValue:e.staff.phone_number,"onUpdate:modelValue":o[3]||(o[3]=l=>e.staff.phone_number=l),type:"tel"},null,8,["modelValue"])]),n("div",T,[t(r,null,{default:i(()=>[d(u(s.$t("keyFob")),1)]),_:1}),t(f,{name:"collect_id",modelValue:e.staff.rfid,"onUpdate:modelValue":o[4]||(o[4]=l=>e.staff.rfid=l)},null,8,["modelValue"])])]),_:1},8,["title","description"]),t(b,{flat:"",bordered:"",title:s.$t("security"),description:s.$t("staff.securityInfo")},{default:i(()=>[n("div",j,[t(r,{required:""},{default:i(()=>[d(u(s.$t("password")),1)]),_:1}),t(f,{type:e.isPwd?"password":"text",modelValue:e.staff.password,"onUpdate:modelValue":o[6]||(o[6]=l=>e.staff.password=l),color:"blue-grey-14",name:"password"},{append:i(()=>[t(w,{name:e.isPwd?"fal fa-eye-slash":"fal fa-eye",class:"cursor-pointer",onClick:o[5]||(o[5]=l=>e.isPwd=!e.isPwd),size:"16px"},null,8,["name"])]),_:1},8,["type","modelValue"])]),n("div",H,[t(r,{required:""},{default:i(()=>[d(u(s.$t("confirmPassword")),1)]),_:1}),t(f,{type:e.isConfPwd?"password":"text",modelValue:e.staff.password_confirmation,"onUpdate:modelValue":o[8]||(o[8]=l=>e.staff.password_confirmation=l),color:"blue-grey-14",name:"password_confirmation"},{append:i(()=>[t(w,{name:e.isConfPwd?"fal fa-eye-slash":"fal fa-eye",class:"cursor-pointer",onClick:o[7]||(o[7]=l=>e.isConfPwd=!e.isConfPwd),size:"16px"},null,8,["name"])]),_:1},8,["type","modelValue"])]),n("div",K,[t(y,{dense:"",modelValue:e.staff.is_active,"onUpdate:modelValue":o[9]||(o[9]=l=>e.staff.is_active=l),label:s.$t("active"),color:"green"},null,8,["modelValue","label"])]),n("div",W,[t(y,{dense:"",modelValue:e.staff.is_instructor,"onUpdate:modelValue":o[10]||(o[10]=l=>e.staff.is_instructor=l),label:s.$t("isInstructor"),color:"green"},null,8,["modelValue","label"])])]),_:1},8,["title","description"]),t(b,{flat:"",bordered:"",title:s.$t("groupsAndPermissions"),description:s.$t("staff.permissionDesc")},{default:i(()=>[n("div",X,[t(r,null,{default:i(()=>[d(u(s.$t("label.groups")),1)]),_:1}),t(S,{"bg-color":"white",placeholder:s.$t("placeholder.select"),dense:"",outlined:"",modelValue:e.staff.groups,"onUpdate:modelValue":[o[11]||(o[11]=l=>e.staff.groups=l),c.onChangeGroup],"filter-method":s.groupList,"map-options":"","use-filter":"",multiple:"","use-chips":"","option-label":"name","option-value":"id"},null,8,["placeholder","modelValue","filter-method","onUpdate:modelValue"])]),n("div",Y,[t(r,null,{default:i(()=>[d(u(s.$t("permissions")),1)]),_:1}),n("div",Z,[(g(!0),v(Q,null,J(e.modules,(l,q)=>(g(),v("div",{class:"col-xs-12 col-sm-4",key:l.id},[t(C,{"has-icon":"",edit:"",modelValue:e.staff.permissions,"onUpdate:modelValue":o[12]||(o[12]=x=>e.staff.permissions=x),"group-permissions":e.staff.groupPermissions,module:e.modules[q]},null,8,["modelValue","group-permissions","module"])]))),128))])])]),_:1},8,["title","description"])])]),_:1},8,["onSubmit","onCancel","onReset","resetable","disable","submited"])):(g(),V(U,{key:1}))]),_:1})}var re=N(I,[["render",$]]);export{re as default};
