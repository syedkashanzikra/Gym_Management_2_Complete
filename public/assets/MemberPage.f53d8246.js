import{Q as H}from"./QSelect.37e8c679.js";import{Q as J}from"./QExpansionItem.fdf07114.js";import{M as P,u as S,N,_ as x,r as m,o as i,d as V,e as n,a as p,g as b,f as o,aE as _,w as r,h as u,t as c,Q as k,ag as z,aF as j,F as G}from"./index.46fdd451.js";import{Q as K}from"./QTimeline.b6d0ce4e.js";import{Q as M,a as W}from"./QTabPanel.ecb3f794.js";import{Q as X}from"./QPage.701dd41d.js";import{u as Y}from"./member.7e2676dd.js";import{U as Z}from"./UserClassSchedules.16366c35.js";import{S as $}from"./SkeletonSinglePage.f05b1d90.js";import{a as A}from"./CurrentPlanCard.5bb21616.js";import{P as ee}from"./ParqForm.480a0115.js";import{F as se}from"./FileSelector.fa33ffa8.js";import{u as te}from"./stripe.esm.e1002465.js";import{P as oe}from"./PaymentMethods.2430131c.js";import{I as le}from"./InvoiceManager.1c290563.js";import{A as re}from"./AddressFields.58941de5.js";import"./QField.98c52be8.js";import"./QChip.2eda5f32.js";import"./QItemLabel.249954d1.js";import"./QMenu.84416a21.js";import"./selection.e9a8e664.js";import"./rtl.b51694b1.js";import"./touch.3df10340.js";import"./QBanner.bf86e8e3.js";import"./QPopupProxy.e4ea2ef4.js";import"./class-schedule.b7d1748f.js";import"./QSkeleton.a3e15f44.js";import"./BaseSectionSkeleton.fd87b72d.js";import"./AddPaymentMethod.07f1e0b4.js";import"./QToolbarTitle.cb225f03.js";import"./QToolbar.72090c76.js";import"./FileCard.22a9b7b0.js";import"./QImg.7965eef6.js";import"./QInnerLoading.1459e1ed.js";import"./PaymentMethodCard.43e041d3.js";import"./QBadge.942c3fbf.js";import"./StateSelect.8267e923.js";import"./index.becf6c0c.js";import"./CitySelect.9ee53a09.js";const ne={components:{CurrentPlanCard:A,PaymentMethods:oe,InvoiceManager:le},props:{user:Object},data(){return{loaded:!1}},methods:{...P(S,["currentUser"]),...P(te,["getSubscribed","getPlans","setUser","removeUser"]),async onLoad(){this.$refs.invoices.onLoad()}},async mounted(){var t;await this.setUser((t=this.user)==null?void 0:t.id),this.loaded=!0,await this.getSubscribed()},computed:{...N(S,["hasCancelled"])},unmounted(){this.removeUser()}},me={class:"row q-col-gutter-md"},ae={class:"col-xs-12 col-sm-8"},ie={class:"q-gutter-md"},de={class:"col-xs-12 col-sm-4"},ue={class:"q-gutter-md"};function ce(t,s,h,v,e,a){const w=m("payment-methods"),d=m("invoice-manager"),q=m("current-plan-card");return i(),V("div",me,[n("div",ae,[n("div",ie,[e.loaded?(i(),p(w,{key:0})):b("",!0),e.loaded?(i(),p(d,{key:1,ref:"invoices"},null,512)):b("",!0)])]),n("div",de,[n("div",ue,[o(q,{onChanged:a.onLoad,"no-upgrade":""},null,8,["onChanged"])])])])}var pe=x(ne,[["render",ce]]);const D={is_enquiry:!0,status:"Pending",title:"Mr",address:{}},be={components:{SkeletonSinglePage:$,UserClassSchedules:Z,ParqForm:ee,FileSelector:se,MemberBilling:pe,CurrentPlanCard:A,AddressFields:re},data(){return{default:_.exports.cloneDeep(D),member:_.exports.cloneDeep(D),isPwd:!0,isConfPwd:!0,loaded:!1,submited:!1,parq:!1,tab:"overview"}},methods:{...P(Y,["store","show","update","notes"]),onSubmit(t){console.func("pages/admins/members/MemberPage:methods.onSubmit()",arguments),this.submited=!0,(this.creating?this.store:this.update)(this.member).then(({data:h,message:v})=>{this.submited=!1,this.$q.notify(v),this.member=h,this.default=_.exports.cloneDeep(h),this.$router.push({name:"Single Member",params:{id:h.id},query:{action:"edit"}})}).catch(h=>{this.submited=!1,this.$core.error(h,{title:this.$t("dialog.title.error")})})},onReset(t){console.func("pages/admins/members/MemberPage:methods.onReset()",arguments),this.loaded=!1,this.$nextTick(()=>{this.member=_.exports.cloneDeep(this.default),this.loaded=!0})},onCancel(t){console.func("pages/admins/members/MemberPage:methods.onCancel()",arguments),this.$router.go(-1)},onChangeStatus(t){console.func("pages/admins/members/MemberPage:methods.onChangeStatus()",arguments),this.member.is_enquiry=t!=="Active",t!=="Hold"&&(this.member.release_at=null)},onCreateNote(t){console.func("pages/admins/members/MemberPage:methods.onCreateNote()",arguments),t?(this.member.notes.splice(0,0,_.exports.cloneDeep(t)),this.default.notes.splice(0,0,_.exports.cloneDeep(t))):this.show(this.id).then(s=>{this.member=s,this.default=_.exports.cloneDeep(s)})}},async mounted(){this.creating?this.loaded=!0:this.show(this.id).then(async t=>{this.member=t,this.default=_.exports.cloneDeep(t),this.loaded=!0}).catch(t=>{this.$emit("error",t)})},computed:{...N(S,["user"]),edit(){return["add","edit"].includes(this.action)||this.id==="add"},creating(){return this.id==="add"},memberOnly(){return!this.creating&&!this.member.is_enquiry},id(){return this.$route.params.id},action(){return this.$route.query.action},disable(){return this.default&&JSON.stringify(this.member)===JSON.stringify(this.default)},resetable(){return this.default&&JSON.stringify(this.member)!==JSON.stringify(this.default)},hasClasses(){return!this.creating&&!this.member.is_enquiry},statusParq(){return this.member.has_parq?"Completed":"Required"}}},fe={class:"row q-col-gutter-md"},_e={class:"col-xs-12 col-sm-8"},he={class:"q-gutter-md"},ge={class:"col-xs-12 col-sm-4"},ye={class:"col-xs-12 col-sm-4"},Ve={class:"col-xs-12 col-sm-4"},ve={class:"col-xs-12 col-sm-4"},we={class:"col-xs-12 col-sm-4"},qe={key:0,class:"col-xs-12 col-sm-4"},Ce={key:1,class:"col-xs-12 col-sm-4"},Pe={class:"col-xs-12 col-sm-4"},Se={key:2,class:"col-xs-12 col-sm-4"},Ue={class:"col-xs-12 col-sm-4"},ke={class:"col-xs-12 col-sm-4"},Me={key:3,class:"col-xs-12 col-sm-12"},De={class:"col-xs-12 col-sm-4"},Ne={class:"col-xs-12 col-sm-4"},xe={class:"col-xs-12 col-sm-4"},Ae={class:"col-xs-12"},Qe={class:"col-xs-12"};function Fe(t,s,h,v,e,a){const w=m("base-page-header"),d=m("base-label"),q=m("base-select"),f=m("base-input"),C=m("base-date-input"),Q=m("parq-form"),g=m("base-section"),F=m("address-fields"),O=m("user-class-schedules"),U=m("base-note-card"),B=m("current-plan-card"),I=m("base-btn"),R=m("file-selector"),L=m("base-form"),T=m("skeleton-single-page"),E=m("member-billing");return i(),p(X,{padding:""},{default:r(()=>[o(w,{class:"q-mb-md",title:a.creating?t.$t("createNew"):e.member.name,hint:t.$t("hint.member"),tabs:["Overview","Billing"],modelValue:e.tab,"onUpdate:modelValue":s[0]||(s[0]=y=>e.tab=y),"no-tabs":a.creating},null,8,["title","hint","modelValue","no-tabs"]),o(W,{class:"base-tab-panels",modelValue:e.tab,"onUpdate:modelValue":s[22]||(s[22]=y=>e.tab=y)},{default:r(()=>[o(M,{name:"overview"},{default:r(()=>[e.loaded?(i(),p(L,{key:0,onSubmit:a.onSubmit,onCancel:a.onCancel,onReset:a.onReset,resetable:a.resetable,disable:a.disable,submited:e.submited},{default:r(()=>{var y;return[n("div",fe,[n("div",_e,[n("div",he,[o(g,{flat:"",bordered:"",title:t.$t("generalInformation"),description:t.$t("members.generalDesc")},{default:r(()=>[n("div",ge,[o(d,null,{default:r(()=>[u(c(t.$t("title")),1)]),_:1}),o(q,{modelValue:e.member.title,"onUpdate:modelValue":s[1]||(s[1]=l=>e.member.title=l),dense:"",outlined:"",options:["Mr","Mrs","Ms","Miss","Mx","Dr","Fr","Prof"],name:"title"},null,8,["modelValue"])]),n("div",ye,[o(d,null,{default:r(()=>[u(c(t.$t("firstName")),1)]),_:1}),o(f,{modelValue:e.member.first_name,"onUpdate:modelValue":s[2]||(s[2]=l=>e.member.first_name=l),name:"first_name"},null,8,["modelValue"])]),n("div",Ve,[o(d,null,{default:r(()=>[u(c(t.$t("surname")),1)]),_:1}),o(f,{modelValue:e.member.last_name,"onUpdate:modelValue":s[3]||(s[3]=l=>e.member.last_name=l),name:"last_name"},null,8,["modelValue"])]),n("div",ve,[o(d,null,{default:r(()=>[u(c(t.$t("emailAddress")),1)]),_:1}),o(f,{modelValue:e.member.email,"onUpdate:modelValue":s[4]||(s[4]=l=>e.member.email=l),name:"email"},null,8,["modelValue"])]),n("div",we,[o(d,null,{default:r(()=>[u(c(t.$t("phoneNumber")),1)]),_:1}),o(f,{modelValue:e.member.phone_number,"onUpdate:modelValue":s[5]||(s[5]=l=>e.member.phone_number=l),name:"phone_number",type:"tel"},null,8,["modelValue"])]),a.memberOnly?(i(),V("div",qe,[o(d,null,{default:r(()=>[u(c(t.$t("startsAt")),1)]),_:1}),o(C,{outlined:"",dense:"",readonly:"",modelValue:e.member.starts_at,"onUpdate:modelValue":s[6]||(s[6]=l=>e.member.starts_at=l),"no-range":"",name:"starts_at"},null,8,["modelValue"])])):b("",!0),a.memberOnly?(i(),V("div",Ce,[o(d,null,{default:r(()=>[u(c(t.$t("endsAt")),1)]),_:1}),o(C,{outlined:"",dense:"",modelValue:e.member.ends_at,"onUpdate:modelValue":s[7]||(s[7]=l=>e.member.ends_at=l),"only-future":"","no-range":"",name:"ends_at",hint:t.$t("hint.endsAt")},null,8,["modelValue","hint"])])):b("",!0),n("div",Pe,[o(d,null,{default:r(()=>[u(c(t.$t("label.status")),1)]),_:1}),o(H,{dense:"",outlined:"",modelValue:e.member.status,"onUpdate:modelValue":[s[8]||(s[8]=l=>e.member.status=l),a.onChangeStatus],options:["Active","Pending","Deactive","Hold","Lost"],name:"status"},null,8,["modelValue","onUpdate:modelValue"])]),e.member.status==="Hold"?(i(),V("div",Se,[o(d,null,{default:r(()=>[u(c(t.$t("releaseAt")),1)]),_:1}),o(C,{outlined:"",dense:"",modelValue:e.member.release_at,"onUpdate:modelValue":s[9]||(s[9]=l=>e.member.release_at=l),name:"release_at"},null,8,["modelValue"])])):b("",!0),n("div",Ue,[o(d,null,{default:r(()=>[u(c(t.$t("collectionsID")),1)]),_:1}),o(f,{name:"collect_id",modelValue:e.member.collect_id,"onUpdate:modelValue":s[10]||(s[10]=l=>e.member.collect_id=l)},null,8,["modelValue"])]),n("div",ke,[o(d,null,{default:r(()=>[u(c(t.$t("keyFob")),1)]),_:1}),o(f,{name:"rfid",modelValue:e.member.rfid,"onUpdate:modelValue":s[11]||(s[11]=l=>e.member.rfid=l)},null,8,["modelValue"])]),a.creating?b("",!0):(i(),V("div",Me,[o(J,{"header-class":"bg-grey-3",icon:"fas fa-clipboard-list-check",label:t.$t("parqStatus",{status:a.statusParq}),onShow:s[13]||(s[13]=l=>e.parq=!0),onHide:s[14]||(s[14]=l=>e.parq=!1)},{default:r(()=>[e.parq?(i(),p(Q,{key:0,class:"q-pa-md border-all",member:e.member,"onUpdate:member":s[12]||(s[12]=l=>e.member=l)},null,8,["member"])):b("",!0)]),_:1},8,["label"])]))]),_:1},8,["title","description"]),o(g,{flat:"",bordered:"",title:t.$t("billingAddress"),description:t.$t("members.billingDesc"),"no-row":""},{default:r(()=>[o(F,{modelValue:e.member.address,"onUpdate:modelValue":s[15]||(s[15]=l=>e.member.address=l)},null,8,["modelValue"])]),_:1},8,["title","description"]),e.member.is_enquiry?b("",!0):(i(),p(g,{key:0,flat:"",bordered:"",title:t.$t("security"),description:t.$t("members.securityDesc")},{default:r(()=>[n("div",De,[o(d,null,{default:r(()=>[u(c(t.$t("password")),1)]),_:1}),o(f,{type:e.isPwd?"password":"text",modelValue:e.member.password,"onUpdate:modelValue":s[17]||(s[17]=l=>e.member.password=l),name:"password",color:"blue-grey-14"},{append:r(()=>[o(k,{name:e.isPwd?"fal fa-eye-slash":"fal fa-eye",class:"cursor-pointer",onClick:s[16]||(s[16]=l=>e.isPwd=!e.isPwd),size:"16px"},null,8,["name"])]),_:1},8,["type","modelValue"])]),n("div",Ne,[o(d,null,{default:r(()=>[u(c(t.$t("confirmPassword")),1)]),_:1}),o(f,{type:e.isConfPwd?"password":"text",modelValue:e.member.password_confirmation,"onUpdate:modelValue":s[19]||(s[19]=l=>e.member.password_confirmation=l),name:"password_confirmation",color:"blue-grey-14"},{append:r(()=>[o(k,{name:e.isConfPwd?"fal fa-eye-slash":"fal fa-eye",class:"cursor-pointer",onClick:s[18]||(s[18]=l=>e.isConfPwd=!e.isConfPwd),size:"16px"},null,8,["name"])]),_:1},8,["type","modelValue"])])]),_:1},8,["title","description"])),a.hasClasses?(i(),p(g,{key:1,flat:"",bordered:"",title:"Class Schedules","no-row":""},{default:r(()=>[o(O,{"no-action":"",class:"q-mt-sm","module-id":e.member.id},null,8,["module-id"])]),_:1})):b("",!0),a.creating?b("",!0):(i(),p(g,{key:2,flat:"",bordered:"",title:t.$t("notes"),description:t.$t("members.activityDesc"),"no-row":"","body-class":"q-px-lg"},{default:r(()=>[o(K,{class:"comments",color:"secondary"},{default:r(()=>[o(U,{"module-action":t.notes,"module-id":e.member.id,class:"comment",creating:"",onCreate:a.onCreateNote},null,8,["module-action","module-id","onCreate"]),(i(!0),V(G,null,z(e.member.notes,l=>(i(),p(U,j({class:"comment",key:l.id},l,{"module-id":e.member.id,user:l.admin}),null,16,["module-id","user"]))),128))]),_:1})]),_:1},8,["title","description"]))])]),n("div",xe,[a.creating?b("",!0):(i(),p(B,{key:0,class:"q-mb-md","user-id":(y=e.member)==null?void 0:y.id,"no-upgrade":""},null,8,["user-id"])),o(g,{flat:"",bordered:"",title:t.$t("specialNote")},{bottom:r(()=>[o(I,{link:"",color:"primary",icon:"fas fa-message",label:t.$t("sendMessage"),to:{name:"Single Enquiry",params:{id:"add"},query:{user:e.member.id}}},null,8,["label","to"])]),default:r(()=>[n("div",Ae,[o(f,{name:"note",modelValue:e.member.note,"onUpdate:modelValue":s[20]||(s[20]=l=>e.member.note=l),type:"textarea"},null,8,["modelValue"])])]),_:1},8,["title"]),o(g,{flat:"",bordered:"",class:"q-mt-md",title:t.$t("avatar")},{default:r(()=>[n("div",Qe,[o(R,{accept:"image/*",icon:"fad fa-image","dialog-label":"uploadAvatar",hint:t.$t("hint.images",{type:"avatar"}),modelValue:e.member.avatar,"onUpdate:modelValue":s[21]||(s[21]=l=>e.member.avatar=l),name:"avatar"},null,8,["hint","modelValue"])])]),_:1},8,["title"])])])]}),_:1},8,["onSubmit","onCancel","onReset","resetable","disable","submited"])):(i(),p(T,{key:1}))]),_:1}),o(M,{name:"billing"},{default:r(()=>[o(E,{user:e.member},null,8,["user"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}var vs=x(be,[["render",Fe]]);export{vs as default};
