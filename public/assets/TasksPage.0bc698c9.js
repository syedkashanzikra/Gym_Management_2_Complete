import{Q as h}from"./QBanner.bf86e8e3.js";import{Q as _}from"./QPopupProxy.e4ea2ef4.js";import{_ as M,M as Q,N as R,r as i,o as u,a as w,w as s,f as o,a5 as g,i as $,e as r,t as d,a4 as y,a8 as v,h as C,d as z,ag as N,F as L,J as V}from"./index.46fdd451.js";import{Q as H}from"./QPage.701dd41d.js";import{u as m}from"./task.d65cd3de.js";import"./QMenu.84416a21.js";import"./selection.e9a8e664.js";const x={data(){return{loading:!1,loaded:!1,pagination:{sortBy:"last_reply",descending:!0,page:1,filter:"",status:this.$route.meta.status,advancedFilter:{},deleted:!1,rowsPerPage:15,rowsNumber:15,loaded:!1},useTaskStore:m()}},methods:{...Q(m,["get","changeArchived"]),onRequest(e){console.func("pages/core/tasks/TasksPage:methods.onRequest()",arguments);const{page:t,rowsPerPage:p,sortBy:f,descending:l}=e.pagination;this.pagination=e.pagination,this.loading=!0,this.get({...e.pagination,direction:l?"desc":"asc"}).then(({meta:n})=>{this.pagination.rowsNumber=n.total,this.pagination.page=t,this.pagination.rowsPerPage=p,this.pagination.sortBy=f,this.pagination.descending=l,this.pagination.loaded=!0,this.pagination.from=n.from,this.pagination.to=n.to,this.loading=!1}).catch(n=>{this.$core.error(n,{title:this.$t("dialog.title.error")})})},async actionClicked(e,t){console.func("pages/core/tasks/TasksPage:methods.actionClicked()",arguments)},async toolbarClicked(e,t){console.func("pages/core/tasks/TasksPage:methods.toolbarClicked()",arguments)},async rowClicked(e,t){console.func("pages/core/tasks/TasksPage:methods.rowClicked()",arguments),this.$router.push({name:"Single Task",params:{id:t.id},query:{action:"edit",title:t.subject}})}},computed:{...R(m,["actions","rows","columns","module","toolbar","filters"])}},A={class:"ellipsis"},D=["innerHTML"],F={class:"q-gutter-xs"},j=["innerHTML"];function U(e,t,p,f,l,n){const c=i("base-btn"),b=i("base-label"),T=i("base-status"),P=i("base-avatar"),q=i("base-table"),S=i("base-section");return u(),w(H,{padding:""},{default:s(()=>[o(S,{flat:"",bordered:"","no-row":""},{default:s(()=>[o(q,{store:l.useTaskStore,module:e.module,actions:e.actions,columns:e.columns,rows:e.rows,toolbar:e.toolbar,filters:e.filters,loading:l.loading,pagination:l.pagination,onRequest:n.onRequest,onToolbarClicked:n.toolbarClicked,onRowClicked:n.rowClicked,"no-data-label":e.$t("tasks.noData"),"table-key":"tasks"},{"body-cell-id":s(a=>[o(c,{onClick:t[0]||(t[0]=g(()=>{},["stop"])),link:"",size:"12px",tag:"a",align:"left",to:{name:"Single Task",params:{id:a.row.id},query:{action:"edit",title:a.row.subject}},style:$(a.col.style)},{default:s(()=>[r("div",A,d(a.value),1)]),_:2},1032,["to","style"]),y(o(c,{class:"q-ml-xs",size:"md",link:"",color:"black",icon:"fal fa-align-left",onClick:t[1]||(t[1]=g(()=>{},["stop"]))},{default:s(()=>[o(_,null,{default:s(()=>[o(h,{style:{width:"350px"}},{default:s(()=>[o(b,null,{default:s(()=>[C(d(e.$t("message")),1)]),_:1}),r("span",{innerHTML:a.row.message},null,8,D)]),_:2},1024)]),_:2},1024)]),_:2},1536),[[v,a.row.message]])]),"body-cell-status":s(a=>[o(T,{type:a.value},null,8,["type"])]),"body-cell-users":s(a=>[r("div",F,[(u(!0),z(L,null,N(a.row.users,(k,B)=>(u(),w(P,{key:B,class:"cursor-pointer",user:k,size:"30px"},null,8,["user"]))),128))])]),"body-cell-is_archived":s(a=>[o(V,{"onUpdate:modelValue":k=>e.changeArchived(a.row),size:"sm",dense:"","model-value":a.row.is_archived,color:"green"},null,8,["onUpdate:modelValue","model-value"])]),"body-cell-last_reply":s(a=>[y(o(c,{class:"q-mr-xs",size:"md",link:"",color:"black",icon:"fal fa-align-left",onClick:t[2]||(t[2]=g(()=>{},["stop"]))},{default:s(()=>[o(_,null,{default:s(()=>[o(h,{style:{width:"350px"}},{default:s(()=>[o(b,null,{default:s(()=>[C(d(e.$t("lastMessage")),1)]),_:1}),r("span",{innerHTML:e.$core.nl2br(a.row.last_reply.message)},null,8,j)]),_:2},1024)]),_:2},1024)]),_:2},1536),[[v,a.row.last_reply]]),r("span",null,d(a.value),1)]),_:1},8,["store","module","actions","columns","rows","toolbar","filters","loading","pagination","onRequest","onToolbarClicked","onRowClicked","no-data-label"])]),_:1})]),_:1})}var X=M(x,[["render",U]]);export{X as default};
