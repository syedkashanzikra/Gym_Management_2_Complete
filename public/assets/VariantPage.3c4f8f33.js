import{Q as B}from"./QSelect.37e8c679.js";import{_ as J,aE as l,M as y,r,o as d,a as p,w as a,e as u,f as t,d as _,ag as x,h as f,t as b,F as P,K as k,I as g,g as w,ab as z,O as A}from"./index.46fdd451.js";import{Q as h}from"./QItemLabel.249954d1.js";import{Q as T}from"./QPage.701dd41d.js";import{P as E,I as j,u as K}from"./PricingSection.8b2234e0.js";import{F as M}from"./FileSelector.fa33ffa8.js";import{u as Y}from"./index.dbe12f27.js";import{S as G}from"./SkeletonSinglePage.f05b1d90.js";import"./QField.98c52be8.js";import"./QChip.2eda5f32.js";import"./QMenu.84416a21.js";import"./selection.e9a8e664.js";import"./rtl.b51694b1.js";import"./QTd.d26cec80.js";import"./QTable.1702d6ef.js";import"./QMarkupTable.c79e7e8d.js";import"./QToolbarTitle.cb225f03.js";import"./QPopupEdit.af630481.js";import"./FileCard.22a9b7b0.js";import"./QToolbar.72090c76.js";import"./QImg.7965eef6.js";import"./QInnerLoading.1459e1ed.js";import"./tag.19d681e9.js";import"./category.8d269d68.js";import"./collection.a5cbc931.js";import"./QSkeleton.a3e15f44.js";const q={taxable:!1,track_inventory:!1,out_of_stock_track_inventory:!1,stocks:[],price:0,compare_at_price:0,cost_per_item:0},H={components:{PricingSection:E,InventorySection:j,ThumbnailSelector:M,SkeletonSinglePage:G},data(){return{loaded:!1,submited:!1,default:l.exports.cloneDeep(q),variant:l.exports.cloneDeep(q),product:!1,uploaded:[],values:[]}},methods:{...y(Y,{showProduct:"show"}),...y(K,["show","update"]),onSubmit(s){console.func("pages/admins/products/VariantPage:methods.onSubmit()",arguments),this.submited=!0,this.update(this.variant).then(({data:e,message:n})=>{this.submited=!1,this.$q.notify(n),this.variant=l.exports.cloneDeep(e),this.default=l.exports.cloneDeep(e)}).catch(e=>{this.submited=!1,this.$core.error(e,{title:this.$t("dialog.title.error")})})},onUploaded(s){console.func("pages/admins/products/VariantPage:methods.onUploaded()",arguments),this.uploaded.push(s)},onRemoved(s){console.func("pages/admins/products/VariantPage:methods.onRemoved()",arguments),this.uploaded.splice(this.uploaded.findIndex(e=>e.id===s.id),1)},onReset(s){console.func("pages/admins/products/VariantPage:methods.onReset()",arguments),Object.assign(this.variant,l.exports.cloneDeep(this.default))},onCancel(s){console.func("pages/admins/products/VariantPage:methods.onCancel()",arguments),this.$router.back()},onFilterValues(s,e,n,v){console.func("pages/admins/products/VariantPage:methods.onFilterValues()",arguments),this.values=[],Array.isArray(v.values)?e(()=>{const o=s.toLowerCase();this.values=v.values.filter(c=>c.name.toLowerCase().indexOf(o)>-1)}):n()},onChangeVariant(s){this.loaded=!1,this.show({variant_id:s.id}).then(e=>{this.variant=e,this.default=l.exports.cloneDeep(e),this.loaded=!0}).catch(e=>{this.$core.error(e,{title:this.$t("dialog.title.error")})})}},mounted(){this.showProduct(this.product_id).then(s=>{if(this.product=s,!s.has_variant)return this.$router.push({name:"Single Product",params:{id:this.product_id},query:{action:"edit"}}),!1;this.show({variant_id:this.id}).then(e=>{Number(this.product_id)!==e.product_id?this.$emit("error"):(this.variant=l.exports.cloneDeep(e),this.default=l.exports.cloneDeep(e),this.loaded=!0)}).catch(e=>{this.$emit("error",e)})}).catch(s=>{this.$emit("error",s)})},computed:{edit(){return["add","edit"].includes(this.action)},id(){return this.$route.params.variant_id},product_id(){return this.$route.params.product_id},action(){return this.$route.query.action},disable(){return this.default&&JSON.stringify(this.variant)===JSON.stringify(this.default)},resetable(){return this.default&&JSON.stringify(this.variant)!==JSON.stringify(this.default)}},watch:{$route(s,e){console.func("pages/admins/products/VariantPage:watch.$route()",arguments),s.name===e.name&&(this.loaded=!1,this.show({variant_id:this.id}).then(n=>{Number(this.product_id)!==n.product_id?this.$emit("error"):(this.variant=l.exports.cloneDeep(n),this.default=l.exports.cloneDeep(n),this.loaded=!0)}).catch(n=>{this.$emit("error",n)}))}}},W={class:"row q-col-gutter-md"},X={class:"col-xs-12 col-sm-8"},Z={class:"q-gutter-md"},$={class:"col-sm-8"},ee=u("div",{class:"text-h6"},"Options",-1),te={class:"q-pt-sm q-gutter-y-md"},se={class:"col-sm-4"},oe={class:"col-xs-12 col-sm-4"},ae={class:"q-gutter-md"},ie={key:0};function ne(s,e,n,v,o,c){const C=r("base-label"),D=r("thumbnail-selector"),V=r("base-section"),N=r("pricing-section"),Q=r("inventory-section"),S=r("base-thumbnail"),F=r("base-status"),I=r("base-btn"),O=r("base-form"),R=r("SkeletonSinglePage");return d(),p(T,{padding:""},{default:a(()=>[o.loaded?(d(),p(O,{key:0,onSubmit:c.onSubmit,onCancel:c.onCancel,onReset:c.onReset,resetable:c.resetable,disable:c.disable,submited:o.submited},{default:a(()=>[u("div",W,[u("div",X,[u("div",Z,[t(V,null,{default:a(()=>[u("div",$,[ee,u("div",te,[(d(!0),_(P,null,x(o.variant.options,i=>(d(),_("div",{key:i.id},[t(C,null,{default:a(()=>[f(b(i.name),1)]),_:2},1024),t(B,{dense:"","options-dense":"",outlined:"",modelValue:i.value,"onUpdate:modelValue":m=>i.value=m,options:o.values,"map-options":"","option-label":"name","option-value":"name","emit-value":"","use-input":"","input-debounce":"0","new-value-mode":"add-unique","hide-selected":"","fill-input":"",onInputValue:m=>i.value=m,onFilter:(m,U,L)=>c.onFilterValues(m,U,L,i)},null,8,["modelValue","onUpdate:modelValue","options","onInputValue","onFilter"])]))),128))])]),u("div",se,[t(D,{label:s.$t("label.thumbnail"),"dialog-label":s.$t("label.uploadthumbnail"),hint:"You can only choose images as variant media",icon:"fad fa-image","related-files":o.product.media,modelValue:o.variant.thumbnail,"onUpdate:modelValue":e[0]||(e[0]=i=>o.variant.thumbnail=i)},null,8,["label","dialog-label","related-files","modelValue"])])]),_:1}),t(N,{modelValue:o.variant,"onUpdate:modelValue":e[1]||(e[1]=i=>o.variant=i)},null,8,["modelValue"]),t(Q,{modelValue:o.variant,"onUpdate:modelValue":e[2]||(e[2]=i=>o.variant=i)},null,8,["modelValue"])])]),u("div",oe,[u("div",ae,[t(V,{contentClass:"bg-green-1","no-row":""},{default:a(()=>[o.product?(d(),_("div",ie,[t(k,{class:"q-pa-none"},{default:a(()=>[t(g,{avatar:""},{default:a(()=>[t(S,{size:80,thumbnail:o.product.thumbnail},null,8,["thumbnail"])]),_:1}),t(g,null,{default:a(()=>[t(h,{lines:"2",class:"text-h6"},{default:a(()=>[f(b(o.product.title),1)]),_:1}),t(h,{class:"q-mt-xs"},{default:a(()=>[t(F,{class:"q-ma-none",type:o.product.status},null,8,["type"])]),_:1}),t(h,{class:"q-mt-xs",caption:""},{default:a(()=>[f(b(o.product.variants_count)+" variants ",1)]),_:1}),t(h,null,{default:a(()=>[t(I,{link:"",size:"12px",padding:"0",tag:"a",label:s.$t("label.bankToProduct"),to:{name:"Single Product",params:{id:o.product.id},query:{action:"edit"}}},null,8,["label","to"])]),_:1})]),_:1})]),_:1})])):w("",!0)]),_:1}),t(V,{title:"Variants","no-row":"",bodyClass:"q-pa-none"},{default:a(()=>[t(z),o.product?(d(),p(A,{key:0,class:"bordered"},{default:a(()=>[(d(!0),_(P,null,x(o.product.variants,(i,m)=>(d(),p(k,{to:{name:"Products Variant",params:{product_id:i.product_id,variant_id:i.id}},clickable:"",key:m},{default:a(()=>[t(g,{avatar:""},{default:a(()=>[t(S,{size:50,media:i.thumbnail},null,8,["media"])]),_:2},1024),t(g,{class:"text-bold"},{default:a(()=>[t(h,null,{default:a(()=>[f(b(i.title),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to"]))),128))]),_:1})):w("",!0)]),_:1})])])])]),_:1},8,["onSubmit","onCancel","onReset","resetable","disable","submited"])):(d(),p(R,{key:1}))]),_:1})}var Ie=J(H,[["render",ne]]);export{Ie as default};
