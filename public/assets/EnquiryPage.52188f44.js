import{Q as q}from"./QBanner.bf86e8e3.js";import{Q as k}from"./QPopupProxy.e4ea2ef4.js";import{Q as C}from"./QPage.701dd41d.js";import{cX as x,A as P,_ as v,M,N as p,r,o as S,a as B,w as i,f as o,e as u,n as D,a5 as b,h as g,t as m,a4 as E,a8 as R}from"./index.46fdd451.js";import{u as f}from"./member.7e2676dd.js";import{M as N}from"./MemberDialog.30db186f.js";import"./QMenu.84416a21.js";import"./selection.e9a8e664.js";import"./QSelect.37e8c679.js";import"./QField.98c52be8.js";import"./QChip.2eda5f32.js";import"./QItemLabel.249954d1.js";import"./rtl.b51694b1.js";import"./QExpansionItem.fdf07114.js";import"./QTimeline.b6d0ce4e.js";import"./QInnerLoading.1459e1ed.js";import"./ParqForm.480a0115.js";import"./QToolbarTitle.cb225f03.js";import"./QToolbar.72090c76.js";import"./AddressFields.58941de5.js";import"./StateSelect.8267e923.js";import"./index.becf6c0c.js";import"./CitySelect.9ee53a09.js";const A=e=>[{label:e.$t("label.all"),value:null},{label:e.$t("label.pending"),value:"Pending"},{label:e.$t("label.deactive"),value:"Deactive"},{label:e.$t("label.hold"),value:"Hold"},{label:e.$t("label.lost"),value:"Lost"}],Q=e=>e&&e.options&&e.options.ref?e.options.ref:e&&e.admin?`${e.admin.name}`:"Direct",z=e=>e&&e.admin?`${e.admin.name} on ${e.date_time}`:e?`System on ${e.date_time}`:null,h=x("member/enquiry",{getters:{module:e=>({name:"Members",label:e.$t("modules.members"),singular:e.$t("modules.singular.enquiry"),plural:e.$t("modules.plural.enquiries")}),columns:e=>[{name:"id",align:"left",label:e.$t("label.memberID"),field:"member_id_formated",style:"width: 40px",sortable:!0},{name:"created_at",align:"left",label:e.$t("label.date"),field:"created_at",style:"width: 40px",sortable:!0},{name:"name",align:"left",label:e.$t("label.name"),field:"name",style:"width: 40px",sortable:!0},{name:"email",align:"left",label:e.$t("label.email"),field:"email",style:"width: 40px",sortable:!0},{name:"phone_number",align:"left",label:e.$t("label.contact"),field:"phone_number",style:"width: 40px",sortable:!0},{name:"last_update",align:"left",label:e.$t("label.lastUpdate"),field:"last_update",format:t=>z(t),style:"width: 40px",sortable:!0},{name:"status",align:"center",label:e.$t("label.status"),field:"status",style:"width: 40px",sortable:!0},{name:"created_by",align:"center",label:e.$t("label.createdBy"),field:"created_by",format:t=>Q(t),style:"width: 40px",sortable:!0},{name:"actions",align:"right",sortable:!1}],toolbar:e=>[{label:e.$t("label.trashed"),action:"request",component:"base-toggle",dense:!0,key:"deleted",checkedIcon:"delete",guard:["admins"],deleted:"all"},{title:e.$t("label.status"),action:"request",component:"base-select",dense:!0,outlined:!0,key:"status",placeholder:e.$t("placeholder.select"),optionsDense:!0,style:"width: 180px",mapOptions:!0,emitValue:!0,options:A(e),deleted:"all",prefix:e.$t("prefix.status")},{title:e.$t("label.rag"),action:"request",component:"base-select",dense:!0,outlined:!0,key:"rag",placeholder:e.$t("placeholder.rag"),optionsDense:!0,style:"width: 110px",mapOptions:!0,emitValue:!0,options:[null,"red","green","amber","white"].map(t=>({label:t?`<div class="text-center"><i class="q-icon fas fa-circle rag-${t}" style="font-size: 13px;" aria-hidden="true" role="presentation" ></i></div>`:`<div class="text-center">${e.$t("label.all")}</div>`,value:t})),optionsHtml:!0,prefix:e.$t("prefix.rag"),deleted:"all"},{tooltip:e.$t("tooltip.exportAsCsv"),icon:"fas fa-file-csv",action:"export",color:"primary",deleted:"all",type:"csv",method:e.get},{icon:"fad fa-plus-circle",label:e.$t("label.addEnquiry"),permission:"New",action:"route",params:{id:"add"},route:"Single Member",color:"primary",deleted:"all"}],filters:e=>[]},actions:{get(e){return new Promise((t,d)=>{P.get("users/enquiry",e).then(s=>{this.setRows(s.data),t(s)}).catch(s=>{d(s)})})}}}),T={data(){return{loading:!1,loaded:!1,selected:[],pagination:{sortBy:"id",descending:!0,page:1,filter:"",status:"Pending",rag:null,advancedFilter:{},deleted:!1,rowsPerPage:15,rowsNumber:15,loaded:!1,isEnquiry:!0,includes:["lastUpdate.admin","createdBy.admin"],override:["includes"]},useMemberStore:f()}},methods:{...M(h,["get"]),onRequest(e){console.func("admins/members/EnquiryPage:methods.onRequest()",arguments);const{page:t,rowsPerPage:d,sortBy:s,descending:n}=e.pagination;this.pagination=e.pagination,this.loading=!0,this.get({...e.pagination,direction:n?"desc":"asc"}).then(({meta:l})=>{this.pagination.rowsNumber=l.total,this.pagination.page=t,this.pagination.rowsPerPage=d,this.pagination.sortBy=s,this.pagination.descending=n,this.pagination.loaded=!0,this.pagination.from=l.from,this.pagination.to=l.to,this.loading=!1}).catch(l=>{this.$core.error(l,{title:this.$t("dialog.title.error")})})},async actionClicked(e,t){console.func("admins/members/EnquiryPage:methods.actionClicked()",arguments)},async toolbarClicked(e,t){console.func("admins/members/EnquiryPage:methods.toolbarClicked()",arguments)},rowClicked(e,t){console.func("admins/members/EnquiryPage:methods.rowClicked()",arguments),this.$q.dialog({component:N,componentProps:{title:t.name,id:t.id,isEnquiry:!0}}).onOk(()=>{this.onRequest({pagination:this.pagination})})}},computed:{...p(f,["actions"]),...p(h,["columns","toolbar","filters","module","rows"]),permissions(){return[]}}},V=["innerHTML"];function H(e,t,d,s,n,l){const c=r("base-btn"),y=r("base-status"),w=r("base-label"),_=r("base-table"),$=r("base-section");return S(),B(C,{padding:""},{default:i(()=>[o($,{flat:"",bordered:"","no-row":""},{default:i(()=>[o(_,{store:n.useMemberStore,module:e.module,columns:e.columns,rows:e.rows,actions:e.actions,toolbar:e.toolbar,filters:e.filters,loading:n.loading,pagination:n.pagination,onRequest:l.onRequest,onActionClicked:l.actionClicked,onToolbarClicked:l.toolbarClicked,onRowClicked:l.rowClicked,"no-data-label":e.$t("enquiry.noData"),"table-key":"members/enquiries",selection:"multiple",selected:n.selected,"onUpdate:selected":t[2]||(t[2]=a=>n.selected=a)},{"body-cell-name":i(a=>[u("i",{class:D(`q-mr-sm q-icon fas fa-circle rag-${a.row.rag||"white"}`),style:{"font-size":"8px"},"aria-hidden":"true",role:"presentation"},null,2),o(c,{onClick:t[0]||(t[0]=b(()=>{},["stop"])),link:"",size:"12px",tag:"a",to:{name:"Single Member",params:{id:a.row.id},query:{action:"edit"}}},{default:i(()=>[g(m(a.value),1)]),_:2},1032,["to"])]),"body-cell-status":i(a=>[o(y,{type:a.value},null,8,["type"])]),"body-cell-last_update":i(a=>[E(o(c,{class:"q-mr-xs",size:"md",link:"",color:"black",icon:"fal fa-align-left",onClick:t[1]||(t[1]=b(()=>{},["stop"]))},{default:i(()=>[o(k,null,{default:i(()=>[o(q,{style:{width:"350px"}},{default:i(()=>[o(w,null,{default:i(()=>[g(m(e.$t("label.note")),1)]),_:1}),u("span",{innerHTML:e.$core.nl2br(a.row.last_update.message)},null,8,V)]),_:2},1024)]),_:2},1024)]),_:2},1536),[[R,a.row.last_update]]),u("span",null,m(a.value),1)]),_:1},8,["store","module","columns","rows","actions","toolbar","filters","loading","pagination","onRequest","onActionClicked","onToolbarClicked","onRowClicked","no-data-label","selected"])]),_:1})]),_:1})}var ue=v(T,[["render",H]]);export{ue as default};
