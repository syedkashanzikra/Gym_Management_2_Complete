import{Q as M}from"./QToolbarTitle.cb225f03.js";import{Q}from"./QToolbar.72090c76.js";import{_ as T,M as q,N as V,r as f,o as s,a as c,w as a,f as o,h as p,t as m,d as y,ag as P,J as E,F as x,g as k,aE as L,dE as N}from"./index.46fdd451.js";import{Q as l}from"./QTd.d26cec80.js";import{Q as w}from"./QTr.6cbeded8.js";import{Q as j}from"./QPage.701dd41d.js";import{M as B,u as D}from"./member-report.bbe9f9ac.js";import{u as F}from"./mixins.eaf0c01c.js";import"./member.7e2676dd.js";import"./QItemLabel.249954d1.js";import"./FileSelector.fa33ffa8.js";import"./FileCard.22a9b7b0.js";import"./QImg.7965eef6.js";import"./QInnerLoading.1459e1ed.js";import"./StateSelect.8267e923.js";import"./index.becf6c0c.js";import"./CitySelect.9ee53a09.js";import"./BaseSectionSkeleton.fd87b72d.js";import"./QSkeleton.a3e15f44.js";const{subtractFromDate:S,formatDate:b,getDateDiff:O,extractDate:U}=N,A=new Date,g=(e=A,t)=>{let i=6;return typeof e=="string"&&(e=U(e,"YYYY/MM/DD")),t&&(i=O(e,t,"days")+1),L.exports.range(0,i).map(h=>{let r=S(e,{days:h});return{id:b(r,"DD"),label:b(r,"DD/MM/YYYY"),month:b(r,"MM"),year:b(r,"YYYY"),checked:!1,total:void 0,rolling:void 0,rolling_total:void 0,end_date:void 0,end_date_total:void 0,free:void 0,cancelled_total:void 0,cancelled:void 0,type:null}})},J=g(),$={components:{MembersTable:B},mixins:[F],data(){return{loaded:!0,visiable:!0,rows:J,pagination:{loaded:!0}}},methods:{...q(D,["reportsDaily"]),onChangeDate(e){console.func("pages/admins/members/ReportsDailyPage:methods.onChangeDate()",arguments);const{date:t}=e.pagination;typeof t=="object"&&t?this.rows=g(t.to,t.from):t?this.rows=g(t):this.rows=g()},onRequest(e,t){console.func("pages/admins/members/ReportsDailyPage:methods.onRequest()",arguments),Object.assign(t.row,{total:void 0,rolling:void 0,rolling_total:void 0,end_date:void 0,end_date_total:void 0,free:void 0,cancelled_total:void 0,cancelled:void 0,type:void 0,expand:!1}),e&&this.reportsDaily({day:t.row.id,month:t.row.month,year:t.row.year}).then(i=>{Object.assign(t.row,i)}).catch(i=>{this.$core.error(i,{title:"Error"})})},onLoad(e,t){if(console.func("pages/admins/members/ReportsDailyPage:methods.onLoad()",arguments),e.row.expand&&t===e.row.type){e.row.expand=!1;return}else e.row.expand=!1,e.row.type=null;this.$nextTick(()=>{e.row.type=t,e.row.expand=!0})}},computed:{...V(D,["toolbar","dailyReportColumns"])}},z={key:1};function G(e,t,i,h,r,_){const R=f("base-btn"),Y=f("members-table"),v=f("base-table"),C=f("base-section");return s(),c(j,{padding:""},{default:a(()=>[r.visiable?(s(),c(C,{key:0,"no-row":""},{default:a(()=>[o(v,{"rows-per-page-options":[0],loaded:r.loaded,rows:r.rows,columns:e.dailyReportColumns,toolbar:e.toolbar,pagination:r.pagination,"hide-pagination":"","no-filter":"",onRequest:_.onChangeDate,"no-responsive":""},{"top-left":a(()=>[o(Q,{class:"q-pa-none"},{default:a(()=>[o(M,{class:"text-weight-medium"},{default:a(()=>[p(m(e.$t("label.dailyReports")),1)]),_:1})]),_:1})]),body:a(n=>[o(w,{props:n},{default:a(()=>[(s(!0),y(x,null,P(n.cols,d=>(s(),c(l,{key:d.name,props:n},{default:a(()=>[d.name==="id"?(s(),c(E,{key:0,dense:"",modelValue:n.row.checked,"onUpdate:modelValue":[u=>n.row.checked=u,u=>_.onRequest(u,n)],label:d.value},null,8,["modelValue","onUpdate:modelValue","label"])):(s(),y(x,{key:1},[d.value&&d.load?(s(),c(R,{key:0,link:"",color:"black",onClick:u=>_.onLoad(n,d.name),flat:"",dense:"",label:d.value},null,8,["onClick","label"])):(s(),y("span",z,m(d.value),1))],64))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"]),n.row.expand?(s(),c(w,{key:0,props:n},{default:a(()=>[o(l,{class:"q-pa-none",colspan:"100%"},{default:a(()=>[o(Y,{"no-responsive":"",type:n.row.type,day:n.row.id,month:n.row.month,year:n.row.year},null,8,["type","day","month","year"])]),_:2},1024)]),_:2},1032,["props"])):k("",!0)]),"bottom-row":a(()=>[o(w,null,{default:a(()=>[o(l,{align:"center",class:"text-bold",colspan:"2"}),o(l,{align:"center",class:"text-bold",colspan:"1"},{default:a(()=>[p(m(e.getTotal("rolling_total")),1)]),_:1}),o(l,{align:"center",class:"text-bold",colspan:"1"}),o(l,{align:"center",class:"text-bold",colspan:"1"},{default:a(()=>[p(m(e.getTotal("end_date_total")),1)]),_:1}),o(l,{align:"center",class:"text-bold",colspan:"1"}),o(l,{align:"center",class:"text-bold",colspan:"1"}),o(l,{align:"center",class:"text-bold",colspan:"1"},{default:a(()=>[p(m(e.getTotal("cancelled_total")),1)]),_:1}),o(l,{align:"center",class:"text-bold",colspan:"1"})]),_:1})]),_:1},8,["loaded","rows","columns","toolbar","pagination","onRequest"])]),_:1})):k("",!0)]),_:1})}var fe=T($,[["render",G]]);export{fe as default};
