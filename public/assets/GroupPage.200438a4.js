import{Q as C}from"./QPage.701dd41d.js";import{_ as D,aE as u,M as b,u as N,r as i,o as d,a as m,w as n,e as p,f as o,h as _,t as S,d as y,ag as q,F as G}from"./index.46fdd451.js";import{P as R}from"./PermissionsModule.182b111b.js";import{S as B}from"./SkeletonSinglePage.f05b1d90.js";import{u as J}from"./group.c7cfe585.js";import"./QItemLabel.249954d1.js";import"./QSkeleton.a3e15f44.js";const V={permissions:[]},M={components:{PermissionsModule:R,SkeletonSinglePage:B},data(){return{default:u.exports.cloneDeep(V),group:u.exports.cloneDeep(V),modules:[],groups:[],selected:[],loaded:!1,submited:!1}},methods:{...b(J,["store","show","update"]),...b(N,["getModules"]),onSubmit(e){console.func("pages/core/groups/GroupPage:methods.onSubmit()",arguments),this.submited=!0,(this.creating?this.store:this.update)(this.group).then(({data:r,message:c})=>{this.submited=!1,this.$q.notify(c),this.group=r,this.default=u.exports.cloneDeep(r),this.$router.push({name:"Single Group",params:{id:r.id},query:{action:"edit"}})}).catch(r=>{this.submited=!1,this.$core.error(r,{title:this.$t("dialog.title.error")})})},onReset(e){console.func("pages/core/groups/GroupPage:methods.onReset()",arguments),this.loaded=!1,this.$nextTick(()=>{this.group=u.exports.cloneDeep(this.default),this.loaded=!0})},onCancel(e){console.func("pages/core/groups/GroupPage:methods.onCancel()",arguments),this.$router.go(-1)}},async mounted(){await this.getModules().then(e=>{this.modules=e.modules,this.groups=e.groups}),this.creating?this.loaded=!0:this.show(this.id).then(e=>{this.group=e,this.default=u.exports.cloneDeep(e),this.loaded=!0}).catch(e=>{this.$emit("error",e)})},computed:{edit(){return["add","edit"].includes(this.action)||this.id==="add"},creating(){return this.id==="add"},id(){return this.$route.params.id},action(){return this.$route.query.action},disable(){return this.default&&JSON.stringify(this.group)===JSON.stringify(this.default)},resetable(){return this.default&&JSON.stringify(this.group)!==JSON.stringify(this.default)}}},O={class:"q-gutter-md"},U={class:"col-xs-12 col-sm-12"},$={class:"col-xs-12"},A={class:"row q-col-gutter-md"};function E(e,t,r,c,s,l){const h=i("base-label"),g=i("base-input"),f=i("base-section"),k=i("permissions-module"),x=i("base-form"),P=i("skeleton-single-page");return d(),m(C,{padding:""},{default:n(()=>[s.loaded?(d(),m(x,{key:0,onSubmit:l.onSubmit,onCancel:l.onCancel,onReset:l.onReset,resetable:l.resetable,disable:l.disable,submited:s.submited},{default:n(()=>[p("div",O,[o(f,{flat:"",bordered:"",title:e.$t("generalInformation")},{default:n(()=>[p("div",U,[o(h,{required:""},{default:n(()=>[_(S(e.$t("name")),1)]),_:1}),o(g,{name:"name",modelValue:s.group.name,"onUpdate:modelValue":t[0]||(t[0]=a=>s.group.name=a)},null,8,["modelValue"])]),p("div",$,[o(h,null,{default:n(()=>[_(S(e.$t("description")),1)]),_:1}),o(g,{name:"description",modelValue:s.group.description,"onUpdate:modelValue":t[1]||(t[1]=a=>s.group.description=a),type:"textarea"},null,8,["modelValue"])])]),_:1},8,["title"]),o(f,{flat:"",bordered:"","no-row":"",title:e.$t("permissions"),description:e.$t("staff.permissionDesc")},{default:n(()=>[p("div",A,[(d(!0),y(G,null,q(s.modules,(a,v)=>(d(),y("div",{class:"col-xs-12 col-sm-4",key:a.id},[o(k,{edit:"",modelValue:s.group.permissions,"onUpdate:modelValue":t[2]||(t[2]=w=>s.group.permissions=w),module:s.modules[v]},null,8,["modelValue","module"])]))),128))])]),_:1},8,["title","description"])])]),_:1},8,["onSubmit","onCancel","onReset","resetable","disable","submited"])):(d(),m(P,{key:1}))]),_:1})}var H=D(M,[["render",E]]);export{H as default};
