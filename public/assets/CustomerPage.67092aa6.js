import{cX as E,A as q,_ as P,r as a,o as i,a as x,L as T,w as t,e as s,f as e,l as V,K as S,I as g,h as c,t as m,d as y,F as w,ag as O,Q as U,aE as v,M as B,ah as L,ai as I,J}from"./index.46fdd451.js";import{Q as z}from"./QPage.701dd41d.js";import{A as F}from"./AddressCard.b1b2473e.js";import{Q as k}from"./QItemLabel.249954d1.js";import{S as j}from"./SkeletonSinglePage.f05b1d90.js";import"./QSkeleton.a3e15f44.js";const G=E("customer",{actions:{show(r){return new Promise((o,n)=>{q.get(`customers/${r}`).then(u=>{o(u)}).catch(u=>{n(u)})})},update(r){return new Promise((o,n)=>{q.put(`customers/${r.id}`,r).then(u=>{o(u)}).catch(u=>{n(u)})})}}}),K={props:{order:{type:Object,required:!1},customer:{type:Number,required:!0}},computed:{hasOrder(){return Boolean(this.order)}}},M={class:"row q-col-gutter-md"},X={key:1,class:"row flex-center",style:{height:"250px"}},H={class:"text-center"},W={class:"q-mb-sm"},Y=s("div",{class:"q-my-sm text-h6"}," This customer hasn\u2019t placed any orders. ",-1),Z={class:"text-right"},$={class:"q-gutter-md"};function ee(r,o,n,u,l,_){const C=a("base-status"),p=a("base-thumbnail"),h=a("base-btn"),b=a("base-section");return i(),x(b,{"no-row":"",title:"Last order placed"},T({default:t(()=>[_.hasOrder?(i(),x(S,{key:0,dense:"",class:"q-px-none"},{default:t(()=>[e(g,null,{default:t(()=>[e(k,{class:"q-gutter-y-xs"},{default:t(()=>[s("div",null,[c(" Order "+m(n.order.formated_id)+" ",1),(i(!0),y(w,null,O(n.order.status,f=>(i(),x(C,{key:f.id,type:f.label},null,8,["type"]))),128))]),s("div",null,m(r.$core.money(n.order.grand_total))+" from "+m(n.order.source),1),s("div",M,[(i(!0),y(w,null,O(n.order.line_items,f=>(i(),y("div",{key:f,class:"col-sm-3 col-xs-12"},[e(S,{class:"q-pa-none"},{default:t(()=>[e(g,{avatar:""},{default:t(()=>[e(p,{media:f.thumbnail,size:"40"},null,8,["media"])]),_:2},1024),e(g,null,{default:t(()=>[e(k,{caption:"",lines:"1"},{default:t(()=>[c(m(f.title),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))])]),_:1})]),_:1}),e(g,{side:"",top:""},{default:t(()=>[e(k,{caption:""},{default:t(()=>[c(m(n.order.created_at),1)]),_:1})]),_:1})]),_:1})):(i(),y("div",X,[s("div",H,[s("div",W,[e(U,{color:"grey",name:"fad fa-shopping-cart",size:"100px"})]),Y,e(V,{to:{name:"Single Order",params:{id:"add"},query:{customer:n.customer}},"no-caps":"",color:"primary",label:"Create order"},null,8,["to"])])]))]),_:2},[_.hasOrder?{name:"bottom",fn:t(()=>[s("div",Z,[s("div",$,[e(h,{to:{name:"Orders",query:{customer:n.customer}},link:"","vertical-middel":"",label:"View all orders"},null,8,["to"]),e(V,{to:{name:"Single Order",params:{id:"add"},query:{customer:n.customer}},color:"primary",label:"Create order","no-caps":""},null,8,["to"])])])]),key:"0"}:void 0]),1024)}var te=P(K,[["render",ee]]);const N={email_marketing:!1,collect_tax:!0},se={components:{AddressCard:F,RecentOrder:te,SkeletonSinglePage:j},data(){return{default:v.exports.cloneDeep(N),customer:v.exports.cloneDeep(N),loaded:!1,submited:!1}},methods:{...B(G,["show","update"]),onSubmit(r){console.func("pages/admins/orders/CustomerPage:methods.onSubmit()",arguments),this.submited=!0,this.update(this.customer).then(({data:o,message:n})=>{this.submited=!1,this.$q.notify(n),this.customer=o,this.default=v.exports.cloneDeep(o)}).catch(o=>{this.submited=!1,this.$core.error(o,{title:"Error"})})},onReset(r){console.func("pages/admins/orders/CustomerPage:methods.onReset()",arguments),this.loaded=!1,setTimeout(()=>{Object.assign(this.customer,v.exports.cloneDeep(this.default)),this.loaded=!0},1)},onCancel(r){console.func("pages/admins/orders/CustomerPage:methods.onCancel()",arguments),this.$router.back()}},async mounted(){this.show(this.id).then(r=>{this.customer=r,this.default=v.exports.cloneDeep(r),this.loaded=!0}).catch(r=>{this.$core.error(r,{title:"Error"})})},computed:{id(){return this.$route.params.id},action(){return this.$route.query.action},disable(){return this.default&&JSON.stringify(this.customer)===JSON.stringify(this.default)},resetable(){return this.default&&JSON.stringify(this.customer)!==JSON.stringify(this.default)}}},oe={class:"row q-col-gutter-md"},le={class:"col-xs-12 col-sm-9"},re={class:"q-gutter-md"},ne={class:"col-xs-12 col-sm-4"},ae={class:"col-xs-12 col-sm-4"},de={class:"col-xs-12 col-sm-4"},ce={class:"col-xs-12 col-sm-4"},ie={class:"col-xs-12 col-sm-12"},ue={class:"col-xs-12 col-sm-3"},me={class:"q-gutter-md"},_e={class:"col-sm-12 col-xs-12"},pe={class:"row flex-start"},fe={class:"text-grey"},he={class:"col-sm-12 col-xs-12"},be={class:"col-sm-12 col-xs-12"},ge={class:"text-h6"},xe={class:"text-h6"},ve={class:"col-sm-12 col-xs-12"};function ye(r,o,n,u,l,_){const C=a("recent-order"),p=a("base-label"),h=a("base-input"),b=a("base-section"),f=a("base-btn"),A=a("base-tooltip"),Q=a("address-card"),D=a("base-form"),R=a("skeleton-single-page");return i(),x(z,{padding:""},{default:t(()=>[l.loaded?(i(),x(D,{key:0,onSubmit:_.onSubmit,onCancel:_.onCancel,onReset:_.onReset,resetable:_.resetable,disable:_.disable,submited:l.submited},{default:t(()=>[s("div",oe,[s("div",le,[s("div",re,[e(C,{customer:l.customer.id,order:l.customer.latest_order},null,8,["customer","order"]),e(b,{title:"General information",description:"Customer information forms provide key data on customer that can be used to keep track of who worked for the company, when, and in what positions."},{default:t(()=>[s("div",ne,[e(p,null,{default:t(()=>[c("First Name")]),_:1}),e(h,{modelValue:l.customer.first_name,"onUpdate:modelValue":o[0]||(o[0]=d=>l.customer.first_name=d)},null,8,["modelValue"])]),s("div",ae,[e(p,null,{default:t(()=>[c("Last name")]),_:1}),e(h,{modelValue:l.customer.last_name,"onUpdate:modelValue":o[1]||(o[1]=d=>l.customer.last_name=d)},null,8,["modelValue"])]),s("div",de,[e(p,null,{default:t(()=>[c("Email Address")]),_:1}),e(h,{dense:"",outlined:"",modelValue:l.customer.email,"onUpdate:modelValue":o[2]||(o[2]=d=>l.customer.email=d)},null,8,["modelValue"])]),s("div",ce,[e(p,null,{default:t(()=>[c("Phone Number")]),_:1}),e(h,{modelValue:l.customer.phone_number,"onUpdate:modelValue":o[3]||(o[3]=d=>l.customer.phone_number=d)},null,8,["modelValue"])]),s("div",ie,[e(p,null,{default:t(()=>[c("Customer Note")]),_:1}),e(h,{dense:"",outlined:"",modelValue:l.customer.note,"onUpdate:modelValue":o[4]||(o[4]=d=>l.customer.note=d)},null,8,["modelValue"])])]),_:1})])]),s("div",ue,[s("div",me,[e(b,{title:"Customer overview",contentClass:"bg-green-1"},{default:t(()=>[s("div",_e,[s("div",pe,[e(f,{link:"",padding:"0",label:l.customer.email},null,8,["label"]),e(V,{onClick:o[5]||(o[5]=d=>r.$core.copyToClipboard(l.customer.email)),flat:"",dense:"",padding:"0",size:"xs",icon:"fas fa-clipboard"},{default:t(()=>[e(A,null,{default:t(()=>[c("Copy email")]),_:1})]),_:1})]),s("div",fe," Created at: "+m(l.customer.created_at),1)]),s("div",he,[e(p,null,{default:t(()=>[c("DEFAULT ADDRESS")]),_:1}),e(Q,L(I(l.customer.address)),null,16)])]),_:1}),e(b,{title:"Activity"},{default:t(()=>[s("div",be,[e(S,{dense:"",class:"q-px-none"},{default:t(()=>[e(g,{class:"text-center"},{default:t(()=>[c(" Total spent in "+m(l.customer.total_orders)+" orders ",1),s("div",ge,m(r.$core.money(l.customer.total_spent)),1)]),_:1}),e(g,{class:"text-center"},{default:t(()=>[c(" Average order amount "),s("div",xe,m(r.$core.money(l.customer.average_order_amount)),1)]),_:1})]),_:1})])]),_:1}),e(b,{title:"Tax exemption"},{default:t(()=>[s("div",ve,[e(J,{dense:"",modelValue:l.customer.collect_tax,"onUpdate:modelValue":o[6]||(o[6]=d=>l.customer.collect_tax=d),label:"Collect tax"},null,8,["modelValue"])])]),_:1})])])])]),_:1},8,["onSubmit","onCancel","onReset","resetable","disable","submited"])):(i(),x(R,{key:1}))]),_:1})}var Oe=P(se,[["render",ye]]);export{Oe as default};
